<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [deepamehta-svn] r260 - in trunk: develop/src/de/deepamehta/service	develop/src/de/deepamehta/service/web	develop/src/de/deepamehta/topics install/examples/kompetenzstern
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/deepamehta-svn/2008-February/index.html" >
   <LINK REL="made" HREF="mailto:deepamehta-svn%40lists.berlios.de?Subject=Re%3A%20%5Bdeepamehta-svn%5D%20r260%20-%20in%20trunk%3A%20develop/src/de/deepamehta/service%0A%09develop/src/de/deepamehta/service/web%0A%09develop/src/de/deepamehta/topics%20install/examples/kompetenzstern&In-Reply-To=%3C200802011302.m11D2wsE023327%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000106.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[deepamehta-svn] r260 - in trunk: develop/src/de/deepamehta/service	develop/src/de/deepamehta/service/web	develop/src/de/deepamehta/topics install/examples/kompetenzstern</H1>
    <B>jri at mail.berlios.de</B> 
    <A HREF="mailto:deepamehta-svn%40lists.berlios.de?Subject=Re%3A%20%5Bdeepamehta-svn%5D%20r260%20-%20in%20trunk%3A%20develop/src/de/deepamehta/service%0A%09develop/src/de/deepamehta/service/web%0A%09develop/src/de/deepamehta/topics%20install/examples/kompetenzstern&In-Reply-To=%3C200802011302.m11D2wsE023327%40sheep.berlios.de%3E"
       TITLE="[deepamehta-svn] r260 - in trunk: develop/src/de/deepamehta/service	develop/src/de/deepamehta/service/web	develop/src/de/deepamehta/topics install/examples/kompetenzstern">jri at mail.berlios.de
       </A><BR>
    <I>Fri Feb  1 14:02:58 CET 2008</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000106.html">[deepamehta-svn] r261 - in trunk: develop/src/de/deepamehta	develop/src/de/deepamehta/assocs develop/src/de/deepamehta/client	develop/src/de/deepamehta/service develop/src/de/deepamehta/topics	develop/src/de/deepamehta/util install/client/images	install/examples/kompetenzstern/src/de/deepamehta/kompetenzstern/topics
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#105">[ date ]</a>
              <a href="thread.html#105">[ thread ]</a>
              <a href="subject.html#105">[ subject ]</a>
              <a href="author.html#105">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: jri
Date: 2008-02-01 14:02:50 +0100 (Fri, 01 Feb 2008)
New Revision: 260

Modified:
   trunk/develop/src/de/deepamehta/service/ApplicationService.java
   trunk/develop/src/de/deepamehta/service/CorporateCommands.java
   trunk/develop/src/de/deepamehta/service/DeepaMehtaSession.java
   trunk/develop/src/de/deepamehta/service/Session.java
   trunk/develop/src/de/deepamehta/service/web/WebSession.java
   trunk/develop/src/de/deepamehta/topics/ContainerTopic.java
   trunk/develop/src/de/deepamehta/topics/TopicMapTopic.java
   trunk/install/examples/kompetenzstern/build.xml
Log:
1) Feature request #2645 realized (Context-sensitive &quot;Remove&quot; semantic)
2) Feature request #2644 realized (&quot;Search&quot; available also in demo mode)
3) Bug fix: topicmap's new &quot;Delete&quot; context command is not available in demo mode
NOTE: Works together with &quot;Kiezatlas&quot; application revision 40 or later

Modified: trunk/develop/src/de/deepamehta/service/ApplicationService.java
===================================================================
--- trunk/develop/src/de/deepamehta/service/ApplicationService.java	2008-01-22 16:47:33 UTC (rev 259)
+++ trunk/develop/src/de/deepamehta/service/ApplicationService.java	2008-02-01 13:02:50 UTC (rev 260)
@@ -61,14 +61,14 @@
 
 
 /**
- * The &lt;CODE&gt;ApplicationService&lt;/CODE&gt; serves application logic that is encoded into live topics.
- * &lt;P&gt;
- * &lt;IMG SRC=&quot;../../../../../images/3-tier-lcm.gif&quot;&gt;
- * &lt;P&gt;
- * &lt;HR&gt;
- * Last functional change: 4.12.2007 (2.0b8)&lt;BR&gt;
- * Last documentation update: 30.12.2001 (2.0a14-pre5)&lt;BR&gt;
- * J&ouml;rg Richter&lt;BR&gt;
+ * The &lt;code&gt;ApplicationService&lt;/code&gt; serves application logic that is encoded into live topics.
+ * &lt;p&gt;
+ * &lt;img src=&quot;../../../../../images/3-tier-lcm.gif&quot;&gt;
+ * &lt;p&gt;
+ * &lt;hr&gt;
+ * Last functional change: 31.1.2008 (2.0b8)&lt;br&gt;
+ * Last documentation update: 30.12.2001 (2.0a14-pre5)&lt;br&gt;
+ * J&ouml;rg Richter&lt;br&gt;
  * <A HREF="https://lists.berlios.de/mailman/listinfo/deepamehta-svn">jri at freenet.de</A>
  */
 public final class ApplicationService extends BaseTopicMap implements LoginCheck, DeepaMehtaConstants {
@@ -85,9 +85,9 @@
 
 	/**
 	 * The IP address of the server machine.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * Initialized by {@link #ApplicationService constructor}.
-	 * Accessed by {@link #runsAtServerHost}.&lt;BR&gt;
+	 * Accessed by {@link #runsAtServerHost}.&lt;br&gt;
 	 */
 	private String hostAddress;
 
@@ -102,18 +102,18 @@
 	// ---
 
 	/**
-	 * The active installation (type &lt;CODE&gt;tt-installation&lt;/CODE&gt;)
-	 * &lt;P&gt;
-	 * Initialized by by {@link #ApplicationService constructor}.&lt;BR&gt;
+	 * The active installation (type &lt;code&gt;tt-installation&lt;/code&gt;)
+	 * &lt;p&gt;
+	 * Initialized by by {@link #ApplicationService constructor}.&lt;br&gt;
 	 * The installation name is accessed by {@link #getInstallationName}.
 	 */
 	private BaseTopic installation;
 
 	/**
 	 * The properties of the active installation.
-	 * &lt;P&gt;
-	 * Initialized by {@link #ApplicationService constructor}.&lt;BR&gt;
-	 * Accessed by {@link #getInstallationProps}.&lt;BR&gt;
+	 * &lt;p&gt;
+	 * Initialized by {@link #ApplicationService constructor}.&lt;br&gt;
+	 * Accessed by {@link #getInstallationProps}.&lt;br&gt;
 	 * Written to stream by {@link #writeInstallationProps}.
 	 */
 	private Hashtable installationProps;
@@ -122,8 +122,8 @@
 
 	/**
 	 * The datasource used for user authentification.
-	 * &lt;P&gt;
-	 * Initialized by {@link #setAuthentificationSourceTopic}.&lt;BR&gt;
+	 * &lt;p&gt;
+	 * Initialized by {@link #setAuthentificationSourceTopic}.&lt;br&gt;
 	 * Accessed by {@link #getAuthentificationSourceTopic}.
 	 */
 	private AuthentificationSourceTopic authSourceTopic;
@@ -322,7 +322,7 @@
 
 	/**
 	 * ### should have parameters &quot;topicID&quot; and &quot;version&quot; instead of &quot;topic&quot;
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 14.12.2001 (2.0a14-pre4)
 	 *
 	 * @param	session		passed to init() hook (init levels 1-3)
@@ -433,22 +433,22 @@
 	 * &lt;p&gt;
 	 * Note: this is a private method. The application developer is supposed to use the other forms of this method, which
 	 * performs full initialization in terms of triggering the evoke() hook and the init() hook at init levels 2 and 3.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * If a topic with same ID and version already exists in live corporate memory and the
-	 * &lt;CODE&gt;override&lt;/CODE&gt; parameter is set to &lt;CODE&gt;false&lt;/CODE&gt; nothing is performed.
-	 * &lt;P&gt;
+	 * &lt;code&gt;override&lt;/code&gt; parameter is set to &lt;code&gt;false&lt;/code&gt; nothing is performed.
+	 * &lt;p&gt;
 	 * If the topic has a custom implementation the corresponmding class is instantiated (a direct or indirect subclass of
 	 * {@link de.deepamehta.topics.LiveTopic}), the actual classname is determined by the &quot;Implementing Class&quot; property of
 	 * the corresponding type topic. If the &quot;Implementing Class&quot; property is empty, there is no custom implementation and
 	 * a generic {@link de.deepamehta.topics.LiveTopic} is instantiated.
-	 * &lt;P&gt;
-	 * ### should return a LiveTopic and have &quot;directives&quot; as a parameter&lt;BR&gt;
 	 * &lt;p&gt;
+	 * ### should return a LiveTopic and have &quot;directives&quot; as a parameter&lt;br&gt;
+	 * &lt;p&gt;
 	 * References checked: 27.9.2007 (2.0b8)
 	 *
 	 * @param	session		passed to init() hook (init level 1)
 	 *
-	 * @return	If the topic has not been created because it exists already in live corporate memory &lt;CODE&gt;null&lt;/CODE&gt; is
+	 * @return	If the topic has not been created because it exists already in live corporate memory &lt;code&gt;null&lt;/code&gt; is
 	 *			returned. Otherwise possible error directives resulted from creation of an active topic are returned (may
 	 *			be emtpy). Note: if a live topic without custom implementation was created always empty CorporateDirectives
 	 *			are returned.
@@ -515,7 +515,7 @@
 	/**
 	 * The topic is created, loaded, evoked and fully inited.
 	 * No existence check is performed. All Exceptions are catched.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 6.7.2002 (2.0a15-pre9)
 	 *
 	 * @param	topicmapID	passed to evoke() hook
@@ -609,11 +609,11 @@
 	/**
 	 * Creates a topic with specified type and name directly in corporate memory and returns the topic ID.
 	 * Before an existence check is performed. If the topic exists already its ID is returned.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * ### Note: the topic is NOT evoked here -&gt; can be only called for types which have no evoke() implementation
 	 * ### should create a live topic instead
 	 * ### This method is to be dropped
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 21.3.2003 (2.0a18-pre7)
 	 *
 	 * @see		de.deepamehta.topics.WebpageTopic#propertiesChanged
@@ -641,7 +641,7 @@
 	/**
 	 * Creates an association with specified type and topic IDs directly in corporate memory and returns the association ID.
 	 * Before an existence check is performed. If the association exists already its ID is returned.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * ### no evoke() is triggered ### method is to be dropped
 	 *
 	 * @see		de.deepamehta.topics.WebpageTopic#propertiesChanged
@@ -699,7 +699,7 @@
 	 * &lt;p&gt;
 	 * References checked: 27.9.2007 (2.0b8)
 	 *
-	 * @param	directives	may be &lt;CODE&gt;null&lt;/CODE&gt;
+	 * @param	directives	may be &lt;code&gt;null&lt;/code&gt;
 	 *
 	 * @see 	#checkLiveAssociation(BaseAssociation, Session, CorporateDirectives)									false	false
 	 * @see 	#checkLiveAssociation(String assocID, int version, Session, CorporateDirectives)						false	false
@@ -814,7 +814,7 @@
 
 	/**
 	 * Parametric semantic.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 5.5.2002 (2.0a15-pre1)
 	 *
 	 * @throws	DeepaMehtaException			if no matching topics were found
@@ -887,12 +887,12 @@
 
 	/**
 	 * @param	relTopicTypeID	the ID of the topic type to match,
-	 *							if &lt;CODE&gt;null&lt;/CODE&gt; is passed all topic types are matching
+	 *							if &lt;code&gt;null&lt;/code&gt; is passed all topic types are matching
 	 *
 	 * @return	the topics as vector of {@see de.deepamehta.BaseTopic}s
 	 *
 	 * @throws	DeepaMehtaException	if no matching topics were found in corporate
-	 *							memory while &lt;CODE&gt;emptyAllowed&lt;/CODE&gt; is not set.
+	 *							memory while &lt;code&gt;emptyAllowed&lt;/code&gt; is not set.
 	 */
 	public Vector getRelatedTopics(String topicID, String assocTypeID,
 									String relTopicTypeID, int relTopicPos,
@@ -914,13 +914,13 @@
 
 	/**
 	 * ### Creates a container with standard name.
-	 * &lt;P&gt;
-	 * &lt;TABLE&gt;
-	 * &lt;TR&gt;&lt;TD&gt;&lt;B&gt;Called by&lt;/B&gt;&lt;/TD&gt;												&lt;TD&gt;&lt;CODE&gt;evokeContent&lt;/CODE&gt;&lt;/TD&gt;&lt;/TR&gt;
-	 * &lt;TR&gt;&lt;TD&gt;{@link #performGoogleSearch}&lt;/TD&gt;									&lt;TD&gt;&lt;CODE&gt;false&lt;/CODE&gt;&lt;/TD&gt;&lt;/TR&gt;
-	 * &lt;TR&gt;&lt;TD&gt;{@link de.deepamehta.topics.TopicContainerTopic#processQuery}&lt;/TD&gt;	&lt;TD&gt;&lt;CODE&gt;false&lt;/CODE&gt;&lt;/TD&gt;&lt;/TR&gt;
-	 * &lt;TR&gt;&lt;TD&gt;{@link de.deepamehta.topics.ElementContainerTopic#processQuery}&lt;/TD&gt;	&lt;TD&gt;&lt;CODE&gt;true&lt;/CODE&gt;&lt;/TD&gt;&lt;/TR&gt;
-	 * &lt;/TABLE&gt;
+	 * &lt;p&gt;
+	 * &lt;table&gt;
+	 * &lt;tr&gt;&lt;td&gt;&lt;b&gt;Called by&lt;/b&gt;&lt;/td&gt;												&lt;td&gt;&lt;code&gt;evokeContent&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;
+	 * &lt;tr&gt;&lt;td&gt;{@link #performGoogleSearch}&lt;/td&gt;									&lt;td&gt;&lt;code&gt;false&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;
+	 * &lt;tr&gt;&lt;td&gt;{@link de.deepamehta.topics.TopicContainerTopic#processQuery}&lt;/td&gt;	&lt;td&gt;&lt;code&gt;false&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;
+	 * &lt;tr&gt;&lt;td&gt;{@link de.deepamehta.topics.ElementContainerTopic#processQuery}&lt;/td&gt;	&lt;td&gt;&lt;code&gt;true&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;
+	 * &lt;/table&gt;
 	 */
 	public CorporateDirectives createNewContainer(LiveTopic relatedTopic, String containerType, String nameFilter,
 											Hashtable propertyFilter, String relatedTopicID, String relatedTopicSemantic,
@@ -931,29 +931,29 @@
 
 	/**
 	 * ### Creates a container with a custom name.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * Creates and returns the client directives to perform the following task: create a new container, associate
-	 * the container with the specified &lt;CODE&gt;relatedTopic&lt;/CODE&gt; by means of an association of type
+	 * the container with the specified &lt;code&gt;relatedTopic&lt;/code&gt; by means of an association of type
 	 * {@link #SEMANTIC_CONTAINER_HIERARCHY} and reveal the contents of the container if they are sufficiently small.
 	 * &quot;Revealing the contents&quot; means showing the contained topics and associating them with the container by means
 	 * of associations of type {@link #SEMANTIC_CONTAINER_HIERARCHY}.
-	 * &lt;P&gt;
-	 * If the &lt;CODE&gt;relatedTopic&lt;/CODE&gt; is itself a container and it has the same content no new container is created,
+	 * &lt;p&gt;
+	 * If the &lt;code&gt;relatedTopic&lt;/code&gt; is itself a container and it has the same content no new container is created,
 	 * but the content is revealed as described.
-	 * &lt;P&gt;
-	 * &lt;TABLE&gt;
-	 * &lt;TR&gt;&lt;TD&gt;&lt;B&gt;Called by&lt;/B&gt;&lt;/TD&gt;													&lt;TD&gt;&lt;CODE&gt;evokeContent&lt;/CODE&gt;&lt;/TD&gt;&lt;/TR&gt;
-	 * &lt;TR&gt;&lt;TD&gt;{@link de.deepamehta.topics.LiveTopic#navigateByTopictype}&lt;/TD&gt;			&lt;TD&gt;&lt;CODE&gt;false&lt;/CODE&gt;&lt;/TD&gt;&lt;/TR&gt;
-	 * &lt;TR&gt;&lt;TD&gt;{@link de.deepamehta.topics.LiveTopic#navigateByAssoctype}&lt;/TD&gt;			&lt;TD&gt;&lt;CODE&gt;false&lt;/CODE&gt;&lt;/TD&gt;&lt;/TR&gt;
-	 * &lt;/TABLE&gt;
+	 * &lt;p&gt;
+	 * &lt;table&gt;
+	 * &lt;tr&gt;&lt;td&gt;&lt;b&gt;Called by&lt;/b&gt;&lt;/td&gt;													&lt;td&gt;&lt;code&gt;evokeContent&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;
+	 * &lt;tr&gt;&lt;td&gt;{@link de.deepamehta.topics.LiveTopic#navigateByTopictype}&lt;/td&gt;			&lt;td&gt;&lt;code&gt;false&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;
+	 * &lt;tr&gt;&lt;td&gt;{@link de.deepamehta.topics.LiveTopic#navigateByAssoctype}&lt;/td&gt;			&lt;td&gt;&lt;code&gt;false&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;
+	 * &lt;/table&gt;
 	 *
 	 * @param	relatedTopic			the topic the container is visually associated.
 	 *									Note: don't confuse this paramter with the relation filter
 	 * @param	containerTypeID			type ID of the container to be created
-	 * @param	nameFilter				name filter, if &lt;CODE&gt;null&lt;/CODE&gt; no name filter is set
-	 * @param	propertyFilter			property filter, if empty no property filter is set ### must not be &lt;CODE&gt;null&lt;/CODE&gt;
-	 * @param	relatedTopicID			relation filter, if &lt;CODE&gt;null&lt;/CODE&gt; no relation filter is set
-	 * @param	relatedTopicSemantic	part of relation filter, if &lt;CODE&gt;null&lt;/CODE&gt; the association type doesn't matter
+	 * @param	nameFilter				name filter, if &lt;code&gt;null&lt;/code&gt; no name filter is set
+	 * @param	propertyFilter			property filter, if empty no property filter is set ### must not be &lt;code&gt;null&lt;/code&gt;
+	 * @param	relatedTopicID			relation filter, if &lt;code&gt;null&lt;/code&gt; no relation filter is set
+	 * @param	relatedTopicSemantic	part of relation filter, if &lt;code&gt;null&lt;/code&gt; the association type doesn't matter
 	 * @param	topicCount				number of topics contained in the container
 	 * @param	topics					topics contained in the container (vector of {@link de.deepamehta.PresentableTopic}s),
 	 *									Note: only used if topicCount &lt;= MAX_REVEALING
@@ -1073,11 +1073,11 @@
 	 * Triggers the {@link de.deepamehta.topics.LiveTopic#disabledProperties disabledProperties() hook}
 	 * and returns the resulting property names.
 	 * &lt;p&gt;
-	 * Called for &lt;CODE&gt;DIRECTIVE_SELECT_TOPIC&lt;/CODE&gt; and &lt;CODE&gt;DIRECTIVE_SELECT_TOPICMAP&lt;/CODE&gt;.
+	 * Called for &lt;code&gt;DIRECTIVE_SELECT_TOPIC&lt;/code&gt; and &lt;code&gt;DIRECTIVE_SELECT_TOPICMAP&lt;/code&gt;.
 	 * &lt;p&gt;
 	 * References checked: 7.6.2007 (2.0b8)
 	 *
-	 * @return	A vector of property names (&lt;CODE&gt;String&lt;/CODE&gt;s)
+	 * @return	A vector of property names (&lt;code&gt;String&lt;/code&gt;s)
 	 *
 	 * @see		CorporateDirectives#updateCorporateMemory
 	 */
@@ -1092,11 +1092,11 @@
 	 * Triggers the {@link de.deepamehta.assocs.LiveAssociation#disabledProperties disabledProperties() hook}
 	 * and returns the resulting property names.
 	 * &lt;p&gt;
-	 * Called for &lt;CODE&gt;DIRECTIVE_SELECT_ASSOCIATION&lt;/CODE&gt;.
+	 * Called for &lt;code&gt;DIRECTIVE_SELECT_ASSOCIATION&lt;/code&gt;.
 	 * &lt;p&gt;
 	 * References checked: 7.6.2007 (2.0b8)
 	 *
-	 * @return	A vector of property names (&lt;CODE&gt;String&lt;/CODE&gt;s)
+	 * @return	A vector of property names (&lt;code&gt;String&lt;/code&gt;s)
 	 *
 	 * @see		CorporateDirectives#updateCorporateMemory
 	 */
@@ -1143,7 +1143,7 @@
 	// ---
 
 	/**
-	 * Consulted while server side processing of &lt;CODE&gt;DIRECTIVE_SELECT_TOPIC&lt;/CODE&gt;.
+	 * Consulted while server side processing of &lt;code&gt;DIRECTIVE_SELECT_TOPIC&lt;/code&gt;.
 	 * &lt;p&gt;
 	 * References checked: 22.1.2008 (2.0b8)
 	 *
@@ -1161,7 +1161,7 @@
 	}
 
 	/**
-	 * Consulted while server side processing of &lt;CODE&gt;DIRECTIVE_SELECT_ASSOCIATION&lt;/CODE&gt;.
+	 * Consulted while server side processing of &lt;code&gt;DIRECTIVE_SELECT_ASSOCIATION&lt;/code&gt;.
 	 * &lt;p&gt;
 	 * References checked: 22.1.2008 (2.0b8)
 	 *
@@ -1319,7 +1319,7 @@
 
 	/**
 	 * Evokes the specified live topic.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * Accesses the specified topic in live corporate memory and triggers its
 	 * {@link de.deepamehta.topics.LiveTopic#evoke evoke()} hook with the
 	 * specified parameters.
@@ -1448,7 +1448,7 @@
 	/**
 	 * Returns the directives to delete the specified topic as well as any associations
 	 * this topic is involed in.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * Used by DeepaMehtaServlet.
 	 */
 	public CorporateDirectives deleteTopic(String topicID, int version) {
@@ -1506,7 +1506,7 @@
 
 	/**
 	 * Triggers the nameChanged() hook of the specified topic.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 4.3.2003 (2.0a18-pre4)
 	 *
 	 * @see		#setTopicProperties
@@ -1529,7 +1529,7 @@
 
 	/**
 	 * Triggers the nameChanged() hook of the specified association.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * @see		#setAssocProperties
 	 */
 	public CorporateDirectives changeAssociationName(String assocID, int version, String name) {
@@ -1641,7 +1641,7 @@
 
 	/**
 	 * Sets a topic property.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 6.9.2002 (2.0a16-pre2)
 	 *
 	 * @see		de.deepamehta.kompetenzstern.topics.KompetenzsternTopic#propertiesChanged
@@ -1655,7 +1655,7 @@
 
 	/**
 	 * Sets topic properties.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 13.2.2005 (2.0b5)
 	 *
 	 * @param	topicmapID						### may be null
@@ -1712,7 +1712,7 @@
 
 	/**
 	 * Sets association properties.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 6.9.2002 (2.0a16-pre2)
 	 *
 	 * @see		CorporateDirectives#setAssociationProperties
@@ -1761,7 +1761,7 @@
 	/**
 	 * References checked: 26.9.2002 (2.0a16-pre4)
 	 *
-	 * @return	may return &lt;CODE&gt;null&lt;/CODE&gt;
+	 * @return	may return &lt;code&gt;null&lt;/code&gt;
 	 *
 	 * @see		de.deepamehta.topics.TypeTopic#makeTypeDefinition
 	 */
@@ -1776,7 +1776,7 @@
 	/**
 	 * References checked: 26.9.2002 (2.0a16-pre4)
 	 *
-	 * @return	may return &lt;CODE&gt;null&lt;/CODE&gt;
+	 * @return	may return &lt;code&gt;null&lt;/code&gt;
 	 *
 	 * @see		de.deepamehta.service.web.HTMLGenerator#formFields
 	 * @see		de.deepamehta.service.web.HTMLGenerator#infoFields
@@ -1809,7 +1809,7 @@
 	// ---
 
 	/**
-	 * @return	may return &lt;CODE&gt;null&lt;/CODE&gt;
+	 * @return	may return &lt;code&gt;null&lt;/code&gt;
 	 *
 	 * @see		de.deepamehta.topics.ElementContainerTopic#createTopicFromElement
 	 * @see		de.deepamehta.topics.DataConsumerTopic#createTopicFromElement
@@ -2043,7 +2043,7 @@
 	 *
 	 * @param	topicmap		view to duplicate
 	 * @param	topicmapID		original view ID
-	 * @param	viewMode		view mode of &lt;CODE&gt;topicmap&lt;/CODE&gt; to duplicate
+	 * @param	viewMode		view mode of &lt;code&gt;topicmap&lt;/code&gt; to duplicate
 	 * @param	destTopicmapID	destination view ID
 	 *
 	 * @see		CorporateTopicMap#personalize(String topicmapID)
@@ -2256,8 +2256,8 @@
 	 * Initializes the type definition and appearance of the specified enumerated
 	 * presentable type topics.
 	 *
-	 * @param	triggerInit		if &lt;CODE&gt;true&lt;/CODE&gt; the &lt;CODE&gt;init(2)&lt;/CODE&gt; and
-	 *							&lt;CODE&gt;init(3)&lt;/CODE&gt; hooks of the corresponding proxy
+	 * @param	triggerInit		if &lt;code&gt;true&lt;/code&gt; the &lt;code&gt;init(2)&lt;/code&gt; and
+	 *							&lt;code&gt;init(3)&lt;/code&gt; hooks of the corresponding proxy
 	 *							type topics are triggered ###
 	 *
 	 * @see		#loadKernelTopics							2x	true
@@ -2291,13 +2291,13 @@
 
 	/**
 	 * Initializes the type definition, the type appearance and the 2
-	 * &lt;CODE&gt;disabled&lt;/CODE&gt;, &lt;CODE&gt;hiddenTopicNames&lt;/CODE&gt; flags of the
+	 * &lt;code&gt;disabled&lt;/code&gt;, &lt;code&gt;hiddenTopicNames&lt;/code&gt; flags of the
 	 * specified presentable type topic.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 8.4.2003 (2.0a18-pre9)
 	 *
-	 * @param	session		the client session (passed to &lt;CODE&gt;init()&lt;/CODE&gt; hook).
-	 *						Note: can be &lt;CODE&gt;null&lt;/CODE&gt; if &lt;CODE&gt;triggerInit&lt;/CODE&gt;
+	 * @param	session		the client session (passed to &lt;code&gt;init()&lt;/code&gt; hook).
+	 *						Note: can be &lt;code&gt;null&lt;/code&gt; if &lt;code&gt;triggerInit&lt;/code&gt;
 	 *						is not set.
 	 *
 	 * @see		#initTypeTopics (above)											variable
@@ -2419,11 +2419,11 @@
 
 	/**
 	 * Returns all workspaces the specified user is a member of.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 7.6.2007 (2.0b8)
 	 *
 	 * @return	The workspaces as vector of {@link de.deepamehta.BaseTopic}s
-	 *			(type &lt;CODE&gt;tt-workspace&lt;/CODE&gt;)
+	 *			(type &lt;code&gt;tt-workspace&lt;/code&gt;)
 	 *
 	 * @see		#addGroupWorkspaces
 	 * @see		CorporateCommands#addPublishCommand
@@ -2444,11 +2444,11 @@
 
 	/**
 	 * Returns all members of the specified workspace.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 15.2.2005 (2.0b5)
 	 *
 	 * @return	The members as vector of {@link de.deepamehta.BaseTopic}s
-	 *			(type &lt;CODE&gt;tt-user&lt;/CODE&gt;)
+	 *			(type &lt;code&gt;tt-user&lt;/code&gt;)
 	 *
 	 * @see		#activeWorkspaceSessions
 	 * @see		de.deepamehta.topics.TopicMapTopic#publish
@@ -2463,7 +2463,7 @@
 
 	/**
 	 * Returns the accessible topic types of the specified user resp. workspace.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 9.10.2001 (2.0a12)
 	 *
 	 * @param	id					topic ID of a user resp. workspace
@@ -2472,7 +2472,7 @@
 	 *								{@link #PERMISSION_CREATE_IN_WORKSPACE}
 	 *
 	 * @return	The topic types as vector of {@link de.deepamehta.BaseTopic}s
-	 *			(type &lt;CODE&gt;tt-topictype&lt;/CODE&gt;)
+	 *			(type &lt;code&gt;tt-topictype&lt;/code&gt;)
 	 *
 	 * @see		CorporateCommands#addTopicTypeCommands						3x
 	 * @see		CorporateCommands#addWorkspaceTopicTypeCommands				3x
@@ -2492,7 +2492,7 @@
 
 	/**
 	 * Returns the accessible association types of the specified user resp. workspace.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 10.8.2001 (2.0a11)
 	 *
 	 * @param	id					the topic ID of the user resp. workspace
@@ -2501,7 +2501,7 @@
 	 *								{@link #PERMISSION_CREATE_IN_WORKSPACE} (not used for association types)
 	 *
 	 * @return	The association types as vector of {@link de.deepamehta.BaseTopic}s
-	 *			(type &lt;CODE&gt;tt-assoctype&lt;/CODE&gt;)
+	 *			(type &lt;code&gt;tt-assoctype&lt;/code&gt;)
 	 *
 	 * @see		CorporateCommands#addAssocTypeCommands	3x
 	 */
@@ -2523,7 +2523,7 @@
 	 * Returns all views in use of the specified user.
 	 *
 	 * @return	The views as vector of {@link de.deepamehta.BaseTopic}s
-	 *			(type &lt;CODE&gt;tt-topicmap&lt;/CODE&gt;)
+	 *			(type &lt;code&gt;tt-topicmap&lt;/code&gt;)
 	 *
 	 * @see		InteractionConnection#addViewsInUse
 	 */
@@ -2650,7 +2650,7 @@
 
 	/**
 	 * Returns the sessions of the specified user.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * Note: a user can login from different client machines.
 	 *
 	 * @return	The sessions as vector of {@link Session}s
@@ -2722,7 +2722,7 @@
 	// --- getChatboard (2 forms) ---
 
 	/**
-	 * Returns the chatboard (type &lt;CODE&gt;tt-chatboard&lt;/CODE&gt;) of the specified workspace.
+	 * Returns the chatboard (type &lt;code&gt;tt-chatboard&lt;/code&gt;) of the specified workspace.
 	 * &lt;p&gt;
 	 * References checked: 8.4.2007 (2.0b8)
 	 *
@@ -2780,7 +2780,7 @@
 	// --- getMessageboard (2 forms) ---
 
 	/**
-	 * Returns the messageboard (type &lt;CODE&gt;tt-messageboard&lt;/CODE&gt;) of the specified workspace.
+	 * Returns the messageboard (type &lt;code&gt;tt-messageboard&lt;/code&gt;) of the specified workspace.
 	 * &lt;p&gt;
 	 * References checked: 8.4.2007 (2.0b8)
 	 *
@@ -2838,15 +2838,15 @@
 	// --- getWorkspaceTopicmap (2 forms) ---
 
 	/**
-	 * Returns the workspace topicmap (type &lt;CODE&gt;tt-topicmap&lt;/CODE&gt;) of the specified user
-	 * resp. workspace or &lt;CODE&gt;null&lt;/CODE&gt; if the specified user resp. workspace has no
+	 * Returns the workspace topicmap (type &lt;code&gt;tt-topicmap&lt;/code&gt;) of the specified user
+	 * resp. workspace or &lt;code&gt;null&lt;/code&gt; if the specified user resp. workspace has no
 	 * workspace topicmap.
 	 * &lt;p&gt;
 	 * References checked: 8.4.2007 (2.0b8)
 	 *
-	 * @param	id		The ID of a user (&lt;CODE&gt;type tt-user&lt;/CODE&gt;) resp. workspace (type &lt;CODE&gt;tt-workspace&lt;/CODE&gt;)
+	 * @param	id		The ID of a user (&lt;code&gt;type tt-user&lt;/code&gt;) resp. workspace (type &lt;code&gt;tt-workspace&lt;/code&gt;)
 	 *
-	 * @return	the workspace topicmap (type &lt;CODE&gt;tt-topicmap&lt;/CODE&gt;)
+	 * @return	the workspace topicmap (type &lt;code&gt;tt-topicmap&lt;/code&gt;)
 	 *
 	 * @throws	DeepaMehtaException		if the specified user resp. workspace is not in ApplicationService resp.
 	 *									is not properly initialized (iconfile is unknown)
@@ -2884,7 +2884,7 @@
 	 * &lt;p&gt;
 	 * References checked: 8.4.2007 (2.0b8)
 	 *
-	 * @param	id		The ID of a user (&lt;CODE&gt;type tt-user&lt;/CODE&gt;) resp. workspace (type &lt;CODE&gt;tt-workspace&lt;/CODE&gt;)
+	 * @param	id		The ID of a user (&lt;code&gt;type tt-user&lt;/code&gt;) resp. workspace (type &lt;code&gt;tt-workspace&lt;/code&gt;)
 	 *
 	 * @see		de.deepamehta.topics.UserTopic#nameChanged
 	 * @see		de.deepamehta.topics.WorkspaceTopic#nameChanged
@@ -2930,8 +2930,30 @@
 	}
 
 	/**
+	 * Returns &lt;code&gt;true&lt;/code&gt; if the specified topic is contained in a published topicmap, &lt;code&gt;false&lt;/code&gt; otherwise.
+	 * &lt;p&gt;
+	 * References checked: 29.1.2008 (2.0b8)
+	 *
+	 * @param	topicID		the ID of the topic.
+	 *
+	 * @see		de.deepamehta.topics.ContainerTopic#contextCommands
+	 */
+	public boolean isContainedInPublishedTopicmap(String topicID) {
+		Enumeration e = cm.getViews(topicID, 1, VIEWMODE_USE).elements();
+		while (e.hasMoreElements()) {
+			BaseTopic topicmap = (BaseTopic) e.nextElement();
+			BaseTopic owner = getTopicmapOwner(topicmap.getID());
+			if (owner != null &amp;&amp; owner.getType().equals(TOPICTYPE_WORKSPACE)) {
+				return true;
+			}
+		}
+		return false;
+	}
+
+	/**
 	 * Returns the owner of the specified topicmap. The specified topicmap is expected to exist either
-	 * in a personal workspace or in a shared workspace. Otherwise &lt;CODE&gt;null&lt;/CODE&gt; is returned.
+	 * in a personal workspace or in a shared workspace. Otherwise &lt;code&gt;null&lt;/code&gt; is returned, which
+	 * is the case e.g. for personalized demo topicmaps.
 	 * &lt;p&gt;
 	 * References checked: 24.8.2006 (2.0b8)
 	 *
@@ -2940,7 +2962,7 @@
 	 *						not used in this fashion.
 	 *
 	 * @return	The user resp. workspace as {@link de.deepamehta.BaseTopic}
-	 *			(type &lt;CODE&gt;tt-user&lt;/CODE&gt; resp. &lt;CODE&gt;tt-workspace&lt;/CODE&gt;)
+	 *			(type &lt;code&gt;tt-user&lt;/code&gt; resp. &lt;code&gt;tt-workspace&lt;/code&gt;)
 	 *
 	 * @see		de.deepamehta.topics.ChatTopic#initWorkspace
 	 * @see		de.deepamehta.topics.TopicMapTopic#updateOwnership
@@ -2979,13 +3001,15 @@
 
 	/**
 	 * Returns the user resp. workspace who deploys the specified workspace topicmap
-	 * (type &lt;CODE&gt;tt-topicmap&lt;/CODE&gt;) resp. &lt;CODE&gt;null&lt;/CODE&gt; if the specified
+	 * (type &lt;code&gt;tt-topicmap&lt;/code&gt;) resp. &lt;code&gt;null&lt;/code&gt; if the specified
 	 * topicmap doesn't represent a workspace topicmap.
 	 * &lt;p&gt;
 	 * References checked: 24.8.2006 (2.0b8)
 	 *
+	 * @param	the ID of the workspace topicmap.
+	 *
 	 * @return	The the user resp. workspace as {@link de.deepamehta.BaseTopic}
-	 *			(type &lt;CODE&gt;tt-user&lt;/CODE&gt; resp. &lt;CODE&gt;tt-workspace&lt;/CODE&gt;)
+	 *			(type &lt;code&gt;tt-user&lt;/code&gt; resp. &lt;code&gt;tt-workspace&lt;/code&gt;)
 	 *
 	 * @see		#editorContext
 	 * @see		#getTopicmapOwner
@@ -3008,7 +3032,7 @@
 	 * Returns the view the specified topic is involved in.
 	 *
 	 * @return	The view as {@link de.deepamehta.BaseTopic}
-	 *			(type &lt;CODE&gt;tt-topicmap&lt;/CODE&gt;)
+	 *			(type &lt;code&gt;tt-topicmap&lt;/code&gt;)
 	 */
 	public BaseTopic getView(String topicID, int version, String viewmode) {
 		Vector views = cm.getViews(topicID, version, viewmode);
@@ -3048,7 +3072,7 @@
 	}
 
 	/**
-	 * @return	the matching association or &lt;CODE&gt;null&lt;/CODE&gt; if &lt;CODE&gt;emptyAllowed&lt;/CODE&gt;
+	 * @return	the matching association or &lt;code&gt;null&lt;/code&gt; if &lt;code&gt;emptyAllowed&lt;/code&gt;
 	 *			is set and no matching association is found
 	 *
 	 * @see		de.deepamehta.topics.TopicMapTopic#executeCommand
@@ -3072,7 +3096,7 @@
 	/**
 	 * Wrapper for {@link CorporateMemory#getTopics(String type, Hashtable propertyFilter, String topicmapID)}
 	 * which throws semantical exceptions.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 30.12.2001 (2.0a14-pre5)
 	 *
 	 * @throws	DeepaMehtaException			if no matching topic is found in corporate
@@ -3100,15 +3124,15 @@
 	/**
 	 * Wrapper for {@link CorporateMemory#getRelatedAssociations(String topicID, String assocTypeID, int relTopicPos, String relTopicTypeID)}
 	 * which throws semantical exceptions.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 30.12.2001 (2.0a14-pre5)
 	 *
 	 * @param	emptyAllowed	### required? -- currently null is passed always
 	 *
-	 * @return	the matching association or &lt;CODE&gt;null&lt;/CODE&gt; if &lt;CODE&gt;emptyAllowed&lt;/CODE&gt;
+	 * @return	the matching association or &lt;code&gt;null&lt;/code&gt; if &lt;code&gt;emptyAllowed&lt;/code&gt;
 	 *			is set and no matching association is found
 	 *
-	 * @throws	DeepaMehtaException			if &lt;CODE&gt;emptyAllowed&lt;/CODE&gt; is not set and
+	 * @throws	DeepaMehtaException			if &lt;code&gt;emptyAllowed&lt;/code&gt; is not set and
 	 *										no matching association is found
 	 * @throws	AmbiguousSemanticException	if more than one matching association are
 	 *										found
@@ -3184,28 +3208,35 @@
 
 	/**
 	 * Returns the users default workspace resp. null if the user has no one.
+	 * &lt;p&gt;
+	 * References checked: 31.1.2008 (2.0b8)
 	 *
 	 * @return	the users default workspace as {@link de.deepamehta.BaseTopic}
-	 *			(type &lt;CODE&gt;tt-workspace&lt;/CODE&gt;) or &lt;code&gt;null&lt;/code&gt;
+	 *			(type &lt;code&gt;tt-workspace&lt;/code&gt;) or &lt;code&gt;null&lt;/code&gt;
 	 *
 	 * @see		CorporateCommands#addPublishCommand
 	 * @see		CorporateCommands#addTopicTypeCommands
 	 * @see		CorporateCommands#addAssocTypeCommands
 	 * @see		CorporateCommands#addWorkspaceTopicTypeCommands
 	 */
-	public BaseTopic getUsersDefaultWorkspace(String userID, CorporateDirectives directives) throws DeepaMehtaException {
+	public BaseTopic getUsersDefaultWorkspace(Session session, CorporateDirectives directives) throws DeepaMehtaException {
 		try {
-			BaseTopic workspace = getRelatedTopic(userID, SEMANTIC_PREFERENCE, TOPICTYPE_WORKSPACE, 2, true);	// emptyAllowed=true
-			//
-			// fallback: the system-wide default workspace is used, provided the user is a member
-			if (workspace == null) {
-				BaseTopic dws = getDefaultWorkspace(directives);
-				if (dws != null &amp;&amp; isMemberOf(userID, dws.getID())) {
-					workspace = dws;
+			if (session.isDemo()) {
+				return getTopicmapOwner(session.getDemoTopicmapID());
+			} else {
+				String userID = session.getUserID();
+				BaseTopic workspace = getRelatedTopic(userID, SEMANTIC_PREFERENCE, TOPICTYPE_WORKSPACE, 2, true);	// emptyAllowed=true
+				//
+				// fallback: the system-wide default workspace is used, provided the user is a member
+				if (workspace == null) {
+					BaseTopic dws = getDefaultWorkspace(directives);
+					if (dws != null &amp;&amp; isMemberOf(userID, dws.getID())) {
+						workspace = dws;
+					}
 				}
+				//
+				return workspace;
 			}
-			//
-			return workspace;
 		} catch (AmbiguousSemanticException e) {
 			System.out.println(&quot;*** ApplicationService.getUsersDefaultWorkspace(): &quot; + e);
 			directives.add(DIRECTIVE_SHOW_MESSAGE, e.getMessage(), new Integer(NOTIFICATION_WARNING));
@@ -3224,7 +3255,7 @@
 	 * References checked: 3.8.2004 (2.0b3)
 	 *
 	 * @return	the system-wide default workspace as {@link de.deepamehta.BaseTopic}
-	 *			(type &lt;CODE&gt;tt-workspace&lt;/CODE&gt;) or &lt;code&gt;null&lt;/code&gt;
+	 *			(type &lt;code&gt;tt-workspace&lt;/code&gt;) or &lt;code&gt;null&lt;/code&gt;
 	 *
 	 * @see		#getUsersDefaultWorkspace
 	 * @see		de.deepamehta.topics.UserTopic#evoke
@@ -3322,11 +3353,11 @@
 
 	/**
 	 * Returns the workspace from which the specified topicmap was opened or
-	 * &lt;CODE&gt;null&lt;/CODE&gt; if the specified topicmap was never published.
+	 * &lt;code&gt;null&lt;/code&gt; if the specified topicmap was never published.
 	 * &lt;p&gt;
 	 * References checked: 24.8.2008 (2.0b8)
 	 *
-	 * @return	the workspace as a {@link de.deepamehta.BaseTopic} (type &lt;CODE&gt;tt-workspace&lt;/CODE&gt;)
+	 * @return	the workspace as a {@link de.deepamehta.BaseTopic} (type &lt;code&gt;tt-workspace&lt;/code&gt;)
 	 *
 	 * @see		CorporateCommands#addPublishCommand
 	 * @see		de.deepamehta.topics.TopicMapTopic#publish
@@ -3380,7 +3411,7 @@
 
 	/**
 	 * Returns the shell command for opening the specified file for the specified user,
-	 * resp. throws a &lt;CODE&gt;DeepaMehtaException&lt;/CODE&gt; if an error occurs.
+	 * resp. throws a &lt;code&gt;DeepaMehtaException&lt;/code&gt; if an error occurs.
 	 *
 	 * @see		de.deepamehta.service.FileserverConnection#performDownload
 	 * @see		de.deepamehta.topics.DocumentTopic#executeCommand
@@ -3504,8 +3535,8 @@
 
 	/**
 	 * @return	The corresponding container-type to the specfied type as a
-	 *			{@link de.deepamehta.BaseTopic} (type &lt;CODE&gt;tt-topictype&lt;/CODE&gt;)
-	 *			or &lt;CODE&gt;null&lt;/CODE&gt; if no container-type exists.
+	 *			{@link de.deepamehta.BaseTopic} (type &lt;code&gt;tt-topictype&lt;/code&gt;)
+	 *			or &lt;code&gt;null&lt;/code&gt; if no container-type exists.
 	 *
 	 * @throws	AmbiguousSemanticException	if more than one container-type exists
 	 *
@@ -3534,7 +3565,7 @@
 	 * References checked: 15.2.2005 (2.0b5)
 	 * 
 	 * @return	The membership association-type to use for joining a user to the specified
-	 *			workgroup as {@link de.deepamehta.BaseTopic} (type &lt;CODE&gt;tt-topictype&lt;/CODE&gt;).
+	 *			workgroup as {@link de.deepamehta.BaseTopic} (type &lt;code&gt;tt-topictype&lt;/code&gt;).
 	 *
 	 * @throws	AmbiguousSemanticException	if more than one association-type is assigned
 	 *
@@ -3562,7 +3593,7 @@
 	 * Returns all topics types that consumes from the specified data source.
 	 *
 	 * @return	The types as vector of {@link de.deepamehta.BaseTopic}s
-	 *			(type &lt;CODE&gt;tt-topictype&lt;/CODE&gt;).
+	 *			(type &lt;code&gt;tt-topictype&lt;/code&gt;).
 	 *
 	 * @see		de.deepamehta.topics.DataSourceTopic#propertiesChanged
 	 */
@@ -3787,7 +3818,7 @@
 	 *
 	 * @see		de.deepamehta.topics.ChatTopic#executeCommand
 	 *
-	 * @return	vector of &lt;CODE&gt;Session&lt;/CODE&gt; elements
+	 * @return	vector of &lt;code&gt;Session&lt;/code&gt; elements
 	 */
 	/* ### public Vector getAllSessions() {
 		Vector sessions = new Vector();
@@ -3962,8 +3993,8 @@
 
 
 	/**
-	 * Returns a new session ID or &lt;CODE&gt;-1&lt;/CODE&gt; if the server is overloaded.
-	 * Valid session are in the range of &lt;CODE&gt;1&lt;/CODE&gt; to
+	 * Returns a new session ID or &lt;code&gt;-1&lt;/code&gt; if the server is overloaded.
+	 * Valid session are in the range of &lt;code&gt;1&lt;/code&gt; to
 	 * {@link DeepaMehtaConstants#MAX_CLIENTS}.
 	 *
 	 * @see		DeepaMehtaServer#runServer
@@ -4029,10 +4060,10 @@
 
 	/**
 	 * Extends the specified directives to let the client create the initial GUI.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * The initial GUI consists of the users &lt;I&gt;workspaces&lt;/I&gt; as well as the &lt;I&gt;views&lt;/I&gt;
 	 * from previous session.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * Called once a user logged in sucessfully.
 	 *
 	 * @return	The user preferences of the specified user.
@@ -4046,7 +4077,7 @@
 		session.setLoggedIn(true);
 		session.setUserID(userID);
 		session.setUserName(userTopic.getName());
-		// ### email checking is disabled. ### threads are not stopped / creates to many threads on the server
+		// ### email checking is disabled. ### threads are not stopped / creates too many threads on the server
 		// ### session.setEmailChecker(new EmailChecker(userID, 1, this));
 		// --- report on server console ---
 		updateServerConsole();
@@ -4063,6 +4094,7 @@
 		// --- initialize session ---
 		String userName = &quot;Guest &quot; + session.getSessionID();
 		session.setDemo(true);
+		session.setDemoTopicmapID(demoMapID);
 		session.setLoggedIn(true);
 		// Note: a demo user has no ID (there is no tt-user topic for a demo user)
 		session.setUserName(userName);
@@ -4100,8 +4132,8 @@
 
 	/**
 	 * @throws	DeepaMehtaException	if the specified message is unknown,
-	 *								known messages are &lt;CODE&gt;import&lt;/CODE&gt;,
-	 *								&lt;CODE&gt;export&lt;/CODE&gt; and &lt;CODE&gt;importCM&lt;/CODE&gt;
+	 *								known messages are &lt;code&gt;import&lt;/code&gt;,
+	 *								&lt;code&gt;export&lt;/code&gt; and &lt;code&gt;importCM&lt;/code&gt;
 	 *
 	 * @see		MessagingConnection#processMessage
 	 */
@@ -4478,13 +4510,13 @@
 	}
 
 	/**
-	 * &lt;TABLE&gt;
-	 * &lt;TR&gt;&lt;TD&gt;&lt;B&gt;Called by&lt;/B&gt;&lt;TD&gt;&lt;CODE&gt;performExistenceCheck&lt;/CODE&gt;
-	 * &lt;TR&gt;&lt;TD&gt;{@link #createNewContainer}&lt;TD&gt;&lt;CODE&gt;false&lt;/CODE&gt;
-	 * &lt;TR&gt;&lt;TD&gt;{@link #createPresentableAssociations}&lt;TD&gt;&lt;CODE&gt;true&lt;/CODE&gt;
-	 * &lt;TR&gt;&lt;TD&gt;{@link de.deepamehta.topics.ElementContainerTopic#autoSearch}&lt;TD&gt;&lt;CODE&gt;false&lt;/CODE&gt;
-	 * &lt;TR&gt;&lt;TD&gt;{@link de.deepamehta.topics.ElementContainerTopic#revealTopic}&lt;TD&gt;&lt;CODE&gt;false&lt;/CODE&gt;
-	 * &lt;/TABLE&gt;
+	 * &lt;table&gt;
+	 * &lt;tr&gt;&lt;td&gt;&lt;b&gt;Called by&lt;/b&gt;&lt;td&gt;&lt;code&gt;performExistenceCheck&lt;/code&gt;
+	 * &lt;tr&gt;&lt;td&gt;{@link #createNewContainer}&lt;td&gt;&lt;code&gt;false&lt;/code&gt;
+	 * &lt;tr&gt;&lt;td&gt;{@link #createPresentableAssociations}&lt;td&gt;&lt;code&gt;true&lt;/code&gt;
+	 * &lt;tr&gt;&lt;td&gt;{@link de.deepamehta.topics.ElementContainerTopic#autoSearch}&lt;td&gt;&lt;code&gt;false&lt;/code&gt;
+	 * &lt;tr&gt;&lt;td&gt;{@link de.deepamehta.topics.ElementContainerTopic#revealTopic}&lt;td&gt;&lt;code&gt;false&lt;/code&gt;
+	 * &lt;/table&gt;
 	 */
 	public PresentableAssociation createPresentableAssociation(String assocTypeID, String assocName,
 									String topicID1, int topicVersion1,
@@ -4630,7 +4662,7 @@
 	/**
 	 * Returns a string containing the comma separated property names
 	 * involved in the specified query.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * This value is used for the &quot;QueryElements&quot; property.
 	 * The value may be the empty string.
 	 *
@@ -4660,7 +4692,7 @@
 	/**
 	 * Returns a string containing the comma separated property values
 	 * involved in the specified query.
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * This string is used as container name.
 	 *
 	 * @see		#createNewContainer
@@ -4725,8 +4757,8 @@
 
 	/**
 	 * Returns the type name of the specified topic.
-	 * &lt;P&gt;
-	 * May be empty, but never &lt;CODE&gt;null&lt;/CODE&gt;.
+	 * &lt;p&gt;
+	 * May be empty, but never &lt;code&gt;null&lt;/code&gt;.
 	 */
 	public String typeName(String typeID) {
 		return type(typeID, 1).getName();
@@ -4734,8 +4766,8 @@
 
 	/**
 	 * Returns the type name of the specified topic.
-	 * &lt;P&gt;
-	 * May be empty, but never &lt;CODE&gt;null&lt;/CODE&gt;.
+	 * &lt;p&gt;
+	 * May be empty, but never &lt;code&gt;null&lt;/code&gt;.
 	 */
 	public String typeName(BaseTopic topic) {
 		return type(topic).getName();
@@ -4744,7 +4776,7 @@
 	// --- type (3 forms) ---
 
 	/**
-	 * Returns the type of the specified topic as live topic (type &lt;CODE&gt;tt-topictype&lt;/CODE&gt;).
+	 * Returns the type of the specified topic as live topic (type &lt;code&gt;tt-topictype&lt;/code&gt;).
 	 *
 	 * @see		#typeName
 	 * @see		#types
@@ -4767,7 +4799,7 @@
 	}
 
 	/**
-	 * Returns the type of the specified association as live topic (type &lt;CODE&gt;tt-assoctype&lt;/CODE&gt;).
+	 * Returns the type of the specified association as live topic (type &lt;code&gt;tt-assoctype&lt;/code&gt;).
 	 *
 	 * @see		de.deepamehta.topics.TopicMapTopic#makeAssociationsXML
 	 */
@@ -4786,7 +4818,7 @@
 	}
 
 	/**
-	 * Returns the specified type as live topic (type &lt;CODE&gt;tt-topictype&lt;/CODE&gt; or &lt;CODE&gt;tt-assoctype&lt;/CODE&gt;).
+	 * Returns the specified type as live topic (type &lt;code&gt;tt-topictype&lt;/code&gt; or &lt;code&gt;tt-assoctype&lt;/code&gt;).
 	 *
 	 * @see		CorporateCommands#addTypeCommands
 	 * @see		CorporateCommands#addTypeCommand
@@ -4836,7 +4868,7 @@
 
 	/**
 	 * Collect the type definitions for the given elements (topics or associations).
-	 * &lt;P&gt;
+	 * &lt;p&gt;
 	 * References checked: 18.4.2002 (2.0a14-post1)
 	 *
 	 * @param   elements    an enumeration of BaseTopics or BaseAssociations
@@ -5164,7 +5196,7 @@
 	}
 
 	/**
-	 * @param	directives	may be &lt;CODE&gt;null&lt;/CODE&gt;
+	 * @param	directives	may be &lt;code&gt;null&lt;/code&gt;
 	 *
 	 * @see		#createLiveAssociation
 	 */
@@ -5187,7 +5219,7 @@
 	// ---
 
 	/**
-	 * @param	directives	may be &lt;CODE&gt;null&lt;/CODE&gt;
+	 * @param	directives	may be &lt;code&gt;null&lt;/code&gt;
 	 *
 	 * @see		#createCustomLiveTopic
 	 * @see		#createCustomLiveAssociation
@@ -5262,7 +5294,7 @@
 	}
 
 	/**
-	 * @param	directives	may be &lt;CODE&gt;null&lt;/CODE&gt;
+	 * @param	directives	may be &lt;code&gt;null&lt;/code&gt;
 	 *
 	 * @see		#createCustomLiveTopic
 	 */
@@ -5290,7 +5322,7 @@
 	}
 
 	/**
-	 * @param	directives	may be &lt;CODE&gt;null&lt;/CODE&gt;
+	 * @param	directives	may be &lt;code&gt;null&lt;/code&gt;
 	 *
 	 * @see		#createCustomLiveTopic
 	 */

Modified: trunk/develop/src/de/deepamehta/service/CorporateCommands.java
===================================================================
--- trunk/develop/src/de/deepamehta/service/CorporateCommands.java	2008-01-22 16:47:33 UTC (rev 259)
+++ trunk/develop/src/de/deepamehta/service/CorporateCommands.java	2008-02-01 13:02:50 UTC (rev 260)
@@ -24,7 +24,7 @@
  * Utility class for building {@link de.deepamehta.Commands topic commands / association commands}.
  * &lt;P&gt;
  * &lt;HR&gt;
- * Last functional change: 15.1.2008 (2.0b8)&lt;BR&gt;
+ * Last functional change: 1.2.2008 (2.0b8)&lt;BR&gt;
  * Last documentation update: 9.10.2001 (2.0a12)&lt;BR&gt;
  * J&ouml;rg Richter&lt;BR&gt;
  * <A HREF="https://lists.berlios.de/mailman/listinfo/deepamehta-svn">jri at freenet.de</A>
@@ -80,13 +80,13 @@
 	/**
 	 * Adds a &quot;Search by Topic Type&quot; command group to this (view) command set.
 	 * &lt;P&gt;
-	 * References checked: 16.6.2002 (2.0a15-pre8)
+	 * References checked: 31.1.2008 (2.0b8)
 	 *
 	 * @see		de.deepamehta.topics.TopicMapTopic#viewCommands
 	 */
-	public void addSearchByTopictypeCommand(String viewmode, Session session,
-													CorporateDirectives directives) {
-		Commands showGroup = addCommandGroup(as.string(ITEM_SEARCH_BY_TOPICTYPE), FILESERVER_IMAGES_PATH, ICON_SEARCH_BY_TOPICTYPE);
+	public void addSearchByTopictypeCommand(String viewmode, Session session, CorporateDirectives directives) {
+		Commands showGroup = addCommandGroup(as.string(ITEM_SEARCH_BY_TOPICTYPE), FILESERVER_IMAGES_PATH,
+																					ICON_SEARCH_BY_TOPICTYPE);
 		addTopicTypeCommands(showGroup, CMD_SEARCH_BY_TOPICTYPE, PERMISSION_VIEW, false, session, directives);
 	}
 
@@ -125,39 +125,52 @@
 	 * @see		de.deepamehta.topics.ChatBoardTopic#viewCommands
 	 */
 	public void addPublishCommand(String topicmapID, Session session, CorporateDirectives directives) {
+		Commands commandGroup = addCommandGroup(as.string(ITEM_PUBLISH), FILESERVER_IMAGES_PATH, ICON_PUBLISH);
+		if (session.isDemo()) {
+			return;
+		}
+		//
 		String userID = session.getUserID();
-		String workspaceID;
-		int cmdState;
-		Commands commandGroup = addCommandGroup(as.string(ITEM_PUBLISH), FILESERVER_IMAGES_PATH, ICON_PUBLISH);
 		BaseTopic workspace = as.getOriginWorkspace(topicmapID);
 		if (workspace == null) {
 			// this topicmap has been created in the users personal workspace originally -- it was never
 			// published. Publishing policy is as follows: it can be published to all workspaces the user
 			// is a member of and has the &quot;Publisher&quot; role.
 			//
+			// Note: although demo topicmaps are always published topicmaps they are regarded as personal topicmaps.
+			// See TopicMapTopic.openSharedTopicmap().
+			//
 			// enable publishing to users default workspace first
-			BaseTopic defaultWorkspace = as.getUsersDefaultWorkspace(userID, directives);
+			BaseTopic defaultWorkspace = as.getUsersDefaultWorkspace(session, directives);
 			String defaultWorkspaceID = null;
 			if (defaultWorkspace != null) {
-				workspaceID = defaultWorkspace.getID();
+				String workspaceID = defaultWorkspace.getID();
 				defaultWorkspaceID = workspaceID;
-				cmdState = as.hasRole(userID, workspaceID, PROPERTY_ROLE_PUBLISHER) ?
+				int cmdState = as.hasRole(userID, workspaceID, PROPERTY_ROLE_PUBLISHER) ?
 					COMMAND_STATE_DEFAULT : COMMAND_STATE_DISABLED;
 				commandGroup.addCommand(defaultWorkspace.getName(), CMD_PUBLISH + COMMAND_SEPARATOR + workspaceID,
 					FILESERVER_ICONS_PATH, as.getIconfile(defaultWorkspace), cmdState);
-				commandGroup.addSeparator();	// ### conditional
 			}
 			// enable publishing to other workspaces the user is a member of
 			Vector workspaces = as.getWorkspaces(userID);
 			Enumeration e = workspaces.elements();
+			boolean isFirst = true;
 			while (e.hasMoreElements()) {
 				BaseTopic workspaceTopic = (BaseTopic) e.nextElement();
-				workspaceID = workspaceTopic.getID();
+				String workspaceID = workspaceTopic.getID();
 				// skip default workspace
 				if (workspaceID.equals(defaultWorkspaceID)) {
 					continue;
 				}
-				cmdState = as.hasRole(userID, workspaceID, PROPERTY_ROLE_PUBLISHER) ?
+				// add separator
+				if (isFirst) {
+					if (!commandGroup.isEmpty()) {
+						commandGroup.addSeparator();
+					}
+					isFirst = false;
+				}
+				//
+				int cmdState = as.hasRole(userID, workspaceID, PROPERTY_ROLE_PUBLISHER) ?
 					COMMAND_STATE_DEFAULT : COMMAND_STATE_DISABLED;
 				commandGroup.addCommand(workspaceTopic.getName(), CMD_PUBLISH + COMMAND_SEPARATOR + workspaceID,
 					FILESERVER_ICONS_PATH, as.getIconfile(workspaceTopic), cmdState);
@@ -165,8 +178,8 @@
 		} else {
 			// this topicmap is a personalized view originating from a shared workspace -- it can be published
 			// &quot;back&quot; to its original workspace.
-			workspaceID = workspace.getID();
-			cmdState = as.hasRole(userID, workspaceID, PROPERTY_ROLE_PUBLISHER) ?
+			String workspaceID = workspace.getID();
+			int cmdState = as.hasRole(userID, workspaceID, PROPERTY_ROLE_PUBLISHER) ?
 				COMMAND_STATE_DEFAULT : COMMAND_STATE_DISABLED;
 			commandGroup.addCommand(workspace.getName(), CMD_PUBLISH + COMMAND_SEPARATOR + workspaceID,
 				FILESERVER_ICONS_PATH, as.getIconfile(workspace), cmdState);
@@ -187,8 +200,7 @@
 	public void addExportCommand(Session session, CorporateDirectives directives) {
 		// --- export command ---
 		int state = session.isDemo() ? COMMAND_STATE_DISABLED : COMMAND_STATE_DEFAULT;
-		addCommand(as.string(ITEM_EXPORT_TOPICMAP), CMD_EXPORT_TOPICMAP,
-			FILESERVER_IMAGES_PATH, ICON_EXPORT_TOPICMAP, state);
+		addCommand(as.string(ITEM_EXPORT_TOPICMAP), CMD_EXPORT_TOPICMAP, FILESERVER_IMAGES_PATH, ICON_EXPORT_TOPICMAP, state);
 		// --- preferences submenu ---
 		Commands prefsGroup = addCommandGroup(as.string(ITEM_PREFERENCES_EXPORT), FILESERVER_ICONS_PATH, ICON_PREFERENCES);
 		if (!session.isDemo()) {
@@ -326,7 +338,7 @@
 		addCommand(as.string(ITEM_HIDE_ASSOC), CMD_HIDE_ASSOC, FILESERVER_IMAGES_PATH, ICON_HIDE_ASSOC);
 	}
 
-	// --- addDeleteTopicCommand (4 forms) ---
+	// --- addDeleteTopicCommand (3 forms) ---
 
 	/**
 	 * Adds a &quot;Delete&quot; command to this (topic) command set.
@@ -348,15 +360,6 @@
 		addCommand(label, CMD_DELETE_TOPIC, FILESERVER_IMAGES_PATH, ICON_DELETE_TOPIC, state);
 	}
 
-	/**
-	 * References checked: 17.2.2005 (2.0b5)
-	 *
-	 * @see		de.deepamehta.topics.ContainerTopic#contextCommands
-	 */
-	public void addDeleteTopicCommand(String label, String iconPath, String iconfile) {
-		addCommand(label, CMD_DELETE_TOPIC, iconPath, iconfile, COMMAND_STATE_DEFAULT);		// ### permission check
-	}
-
 	// --- addDeleteAssociationCommand (3 forms) ---
 
 	/**
@@ -386,8 +389,15 @@
 
 	// ---
 
-	public void addDeleteTopicmapCommand() {
-		addCommand(as.string(ITEM_DELETE_TOPIC), CMD_DELETE_TOPICMAP, FILESERVER_IMAGES_PATH, ICON_DELETE_TOPIC);
+	/**
+	 * References checked: 29.1.2008 (2.0b8)
+	 *
+	 * @see		de.deepamehta.topics.TopicMapTopic#viewCommands
+	 * @see		de.kiezatlas.deepamehta.topics.CityMapTopic#viewCommands
+	 */
+	public void addDeleteTopicmapCommand(Session session) {
+		int state = session.isDemo() ? COMMAND_STATE_DISABLED : COMMAND_STATE_DEFAULT;
+		addCommand(as.string(ITEM_DELETE_TOPIC), CMD_DELETE_TOPICMAP, FILESERVER_IMAGES_PATH, ICON_DELETE_TOPIC, state);
 	}
 
 	// ---
@@ -601,7 +611,7 @@
 	 * &lt;P&gt;
 	 * Used for &quot;Retype&quot;, &quot;Create&quot;, &quot;Search&quot; and workspace's &quot;Assign Topic Type&quot; commands.
 	 * &lt;P&gt;
-	 * References checked: 19.7.2003 (2.0b2)
+	 * References checked: 31.1.2008 (2.0b8)
 	 *
 	 * @see		#addCreateCommands
 	 * @see		#addSearchByTopictypeCommand
@@ -615,7 +625,7 @@
 		String defaultWorkspaceID = null;
 		Vector types;
 		// --- add default types ---
-		defaultWorkspace = as.getUsersDefaultWorkspace(userID, directives);
+		defaultWorkspace = as.getUsersDefaultWorkspace(session, directives);
 		if (defaultWorkspace != null) {
 			defaultWorkspaceID = defaultWorkspace.getID();
 			types = as.getTopicTypes(defaultWorkspaceID, permissionMode);
@@ -632,7 +642,7 @@
 		// --- add workspace types ---
 		Vector workspaces = as.getWorkspaces(userID);
 		Enumeration e = workspaces.elements();
-		boolean first = true;
+		boolean isFirst = true;
 		while (e.hasMoreElements()) {
 			BaseTopic workspace = (BaseTopic) e.nextElement();
 			// skip default workspace
@@ -642,11 +652,11 @@
 			//
 			types = as.getTopicTypes(workspace.getID(), permissionMode);
 			if (!types.isEmpty()) {
-				if (first) {
+				if (isFirst) {
 					if (!commandsGroup.isEmpty()) {
 						commandsGroup.addSeparator();
 					}
-					first = false;
+					isFirst = false;
 				}
 				// create sub menu
 				Commands cmdGroup = commandsGroup.addCommandGroup(workspace.getName(),
@@ -673,7 +683,7 @@
 		String defaultWorkspaceID = null;
 		Vector types;
 		// --- add default types ---
-		defaultWorkspace = as.getUsersDefaultWorkspace(userID, directives);
+		defaultWorkspace = as.getUsersDefaultWorkspace(session, directives);
 		if (defaultWorkspace != null) {
 			defaultWorkspaceID = defaultWorkspace.getID();
 			types = as.getAssociationTypes(defaultWorkspaceID, permissionMode);
@@ -690,7 +700,7 @@
 		// --- add workspace types ---
 		Vector workspaces = as.getWorkspaces(userID);
 		Enumeration e = workspaces.elements();
-		boolean first = true;
+		boolean isFirst = true;
 		while (e.hasMoreElements()) {
 			BaseTopic workspace = (BaseTopic) e.nextElement();
 			// skip default workspace
@@ -699,11 +709,11 @@
 			}
 			types = as.getAssociationTypes(workspace.getID(), permissionMode);
 			if (!types.isEmpty()) {
-				if (first) {
+				if (isFirst) {
 					if (!commandsGroup.isEmpty()) {
 						commandsGroup.addSeparator();
 					}
-					first = false;
+					isFirst = false;
 				}
 				// create sub menu
 				Commands cmdGroup = commandsGroup.addCommandGroup(workspace.getName(),
@@ -727,7 +737,7 @@
 		String defaultWorkspaceID = null;
 		Vector types;
 		// --- add default types ---
-		BaseTopic defaultWorkspace = as.getUsersDefaultWorkspace(userID, directives);
+		BaseTopic defaultWorkspace = as.getUsersDefaultWorkspace(session, directives);
 		if (defaultWorkspace != null) {
 			defaultWorkspaceID = defaultWorkspace.getID();
 			types = as.getTopicTypes(defaultWorkspaceID, PERMISSION_CREATE_IN_WORKSPACE);

Modified: trunk/develop/src/de/deepamehta/service/DeepaMehtaSession.java
===================================================================
--- trunk/develop/src/de/deepamehta/service/DeepaMehtaSession.java	2008-01-22 16:47:33 UTC (rev 259)
+++ trunk/develop/src/de/deepamehta/service/DeepaMehtaSession.java	2008-02-01 13:02:50 UTC (rev 260)
@@ -19,7 +19,7 @@
  * Note: the same user can login from different client machines at the same time.
  * &lt;P&gt;
  * &lt;HR&gt;
- * Last functional change: 24.4.2003 (2.0a18-pre10)&lt;BR&gt;
+ * Last functional change: 31.1.2008 (2.0b8)&lt;BR&gt;
  * Last documentation update: 17.5.2001 (2.0a10-post3)&lt;BR&gt;
  * J&ouml;rg Richter&lt;BR&gt;
  * <A HREF="https://lists.berlios.de/mailman/listinfo/deepamehta-svn">jri at freenet.de</A>
@@ -58,6 +58,8 @@
 	 * Initialized by {@link #setDemo}.
 	 */
 	private boolean isDemo;
+	
+	private String demoTopicmapID;
 
 	/**
 	 * Once logged in, set to (&lt;CODE&gt;true&lt;/CODE&gt;).
@@ -175,6 +177,10 @@
 		return isDemo;
 	}
 
+	public String getDemoTopicmapID() {
+		return demoTopicmapID;
+	}
+
 	public boolean loggedIn() {
 		return loggedIn;
 	}
@@ -220,15 +226,21 @@
 	}
 
 	/**
-	 * @see		ApplicationService#startSession	false
+	 * References checked: 31.1.2008 (2.0b8)
+	 *
+	 * @see		ApplicationService#startSession		false
 	 * @see		ApplicationService#startDemo		true
 	 */
 	public void setDemo(boolean isDemo) {
 		this.isDemo = isDemo;
 	}
 
+	public void setDemoTopicmapID(String demoTopicmapID) {
+		this.demoTopicmapID = demoTopicmapID;
+	}
+
 	/**
-	 * @see		ApplicationService#startSession	true
+	 * @see		ApplicationService#startSession		true
 	 * @see		ApplicationService#startDemo		true
 	 */
 	public void setLoggedIn(boolean loggedIn) {

Modified: trunk/develop/src/de/deepamehta/service/Session.java
===================================================================
--- trunk/develop/src/de/deepamehta/service/Session.java	2008-01-22 16:47:33 UTC (rev 259)
+++ trunk/develop/src/de/deepamehta/service/Session.java	2008-02-01 13:02:50 UTC (rev 260)
@@ -16,7 +16,7 @@
  * Note: the same user can login from different client machines at the same time.
  * &lt;P&gt;
  * &lt;HR&gt;
- * Last functional change: 24.4.2003 (2.0a18-pre10)&lt;BR&gt;
+ * Last functional change: 31.1.2008 (2.0b8)&lt;BR&gt;
  * Last documentation update: 13.12.2002 (2.0a17-pre3)&lt;BR&gt;
  * J&ouml;rg Richter&lt;BR&gt;
  * <A HREF="https://lists.berlios.de/mailman/listinfo/deepamehta-svn">jri at freenet.de</A>
@@ -30,6 +30,7 @@
 	String getHostname();
 	String getAddress();
 	boolean isDemo();
+	String getDemoTopicmapID();
 	boolean loggedIn();
 	String getUserID();
 	String getUserName();
@@ -39,6 +40,7 @@
 	public void setAttribute(String name, Object value);
 	public void removeAttribute(String name);
 	void setDemo(boolean isDemo);
+	void setDemoTopicmapID(String demoTopicmapID);
 	void setLoggedIn(boolean loggedIn);
 	void setUserID(String userID);
 	void setUserName(String userName);

Modified: trunk/develop/src/de/deepamehta/service/web/WebSession.java
===================================================================
--- trunk/develop/src/de/deepamehta/service/web/WebSession.java	2008-01-22 16:47:33 UTC (rev 259)
+++ trunk/develop/src/de/deepamehta/service/web/WebSession.java	2008-02-01 13:02:50 UTC (rev 260)
@@ -21,7 +21,7 @@
  * Note: the same user can login from different client machines at the same time.
  * &lt;P&gt;
  * &lt;HR&gt;
- * Last functional change: 9.7.2004 (2.0b3)&lt;BR&gt;
+ * Last functional change: 31.1.2008 (2.0b8)&lt;BR&gt;
  * Last documentation update: 17.5.2001 (2.0a10-post3)&lt;BR&gt;
  * J&ouml;rg Richter&lt;BR&gt;
  * <A HREF="https://lists.berlios.de/mailman/listinfo/deepamehta-svn">jri at freenet.de</A>
@@ -61,6 +61,8 @@
 	 */
 	// ### private boolean isDemo;
 
+	// ### private String demoTopicmapID;
+
 	/**
 	 * Once logged in, set to (&lt;CODE&gt;true&lt;/CODE&gt;).
 	 * &lt;P&gt;
@@ -172,6 +174,10 @@
 		return false;	// ###
 	}
 
+	public String getDemoTopicmapID() {
+		return null;	// ###
+	}
+
 	public boolean loggedIn() {
 		return false;	// ###
 	}
@@ -220,6 +226,10 @@
 		// ### this.isDemo = isDemo;
 	}
 
+	public void setDemoTopicmapID(String demoTopicmapID) {
+		// ### this.demoTopicmapID = demoTopicmapID;
+	}
+
 	/**
 	 * @see		de.deepamehta.service.ApplicationService#startSession	true
 	 * @see		de.deepamehta.service.ApplicationService#startDemo		true

Modified: trunk/develop/src/de/deepamehta/topics/ContainerTopic.java
===================================================================
--- trunk/develop/src/de/deepamehta/topics/ContainerTopic.java	2008-01-22 16:47:33 UTC (rev 259)
+++ trunk/develop/src/de/deepamehta/topics/ContainerTopic.java	2008-02-01 13:02:50 UTC (rev 260)
@@ -88,7 +88,7 @@
  * &lt;/OL&gt;
  * &lt;P&gt;
  * &lt;HR&gt;
- * Last functional change: 11.9.2007 (2.0b8)&lt;BR&gt;
+ * Last functional change: 29.1.2008 (2.0b8)&lt;BR&gt;
  * Last documentation update: 13.3.2001 (2.0a10-pre1)&lt;BR&gt;
  * J&ouml;rg Richter&lt;BR&gt;
  * <A HREF="https://lists.berlios.de/mailman/listinfo/deepamehta-svn">jri at freenet.de</A>
@@ -246,8 +246,9 @@
 			}
 		}
 		// &quot;Remove&quot;
+		String cmd = as.isContainedInPublishedTopicmap(getID()) ? CMD_HIDE_TOPIC : CMD_DELETE_TOPIC;
 		commands.addSeparator();
-		commands.addDeleteTopicCommand(as.string(ITEM_REMOVE_TOPIC), FILESERVER_IMAGES_PATH, ICON_HIDE_TOPIC);
+		commands.addCommand(as.string(ITEM_REMOVE_TOPIC), cmd, FILESERVER_IMAGES_PATH, ICON_HIDE_TOPIC);
 		//
 		return commands;
 	}

Modified: trunk/develop/src/de/deepamehta/topics/TopicMapTopic.java
===================================================================
--- trunk/develop/src/de/deepamehta/topics/TopicMapTopic.java	2008-01-22 16:47:33 UTC (rev 259)
+++ trunk/develop/src/de/deepamehta/topics/TopicMapTopic.java	2008-02-01 13:02:50 UTC (rev 260)
@@ -84,7 +84,7 @@
  *     ({@link #importFromFile})&lt;/LI&gt;
  * &lt;/OL&gt;
  * &lt;HR&gt;
- * Last functional change: 22.1.2008 (2.0b8)&lt;BR&gt;
+ * Last functional change: 29.1.2008 (2.0b8)&lt;BR&gt;
  * Last documentation update: 11.12.2001 (2.0a14-pre4)&lt;BR&gt;
  * J&ouml;rg Richter&lt;BR&gt;
  * <A HREF="https://lists.berlios.de/mailman/listinfo/deepamehta-svn">jri at freenet.de</A>
@@ -306,7 +306,7 @@
 			//
 			commands.addCloseCommand(session);
 			commands.addHideAllCommands(topicmapID, viewmode, session);
-			commands.addDeleteTopicmapCommand();
+			commands.addDeleteTopicmapCommand(session);
 			commands.addSeparator();
 			//
 			commands.addPublishCommand(getID(), session, directives);

Modified: trunk/install/examples/kompetenzstern/build.xml
===================================================================
--- trunk/install/examples/kompetenzstern/build.xml	2008-01-22 16:47:33 UTC (rev 259)
+++ trunk/install/examples/kompetenzstern/build.xml	2008-02-01 13:02:50 UTC (rev 260)
@@ -20,8 +20,8 @@
 	&lt;target name=&quot;-compile&quot; depends=&quot;-init&quot;&gt;
 		&lt;javac srcdir=&quot;src&quot; destdir=&quot;${build}&quot; debug=&quot;on&quot; listfiles=&quot;yes&quot;&gt;
 			&lt;classpath&gt;
-				&lt;pathelement location=&quot;${web.lib.dir}/DeepaMehtaService.jar&quot; /&gt;
-				&lt;pathelement location=&quot;${web.lib.dir}/DeepaMehtaTopics.jar&quot; /&gt;
+				&lt;pathelement location=&quot;${server}/DeepaMehtaService.jar&quot; /&gt;
+				&lt;pathelement location=&quot;${server}/DeepaMehtaTopics.jar&quot; /&gt;
 				&lt;pathelement location=&quot;${web.servlet.lib}&quot; /&gt;
 			&lt;/classpath&gt;
 		&lt;/javac&gt;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000106.html">[deepamehta-svn] r261 - in trunk: develop/src/de/deepamehta	develop/src/de/deepamehta/assocs develop/src/de/deepamehta/client	develop/src/de/deepamehta/service develop/src/de/deepamehta/topics	develop/src/de/deepamehta/util install/client/images	install/examples/kompetenzstern/src/de/deepamehta/kompetenzstern/topics
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#105">[ date ]</a>
              <a href="thread.html#105">[ thread ]</a>
              <a href="subject.html#105">[ subject ]</a>
              <a href="author.html#105">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/deepamehta-svn">More information about the deepamehta-svn
mailing list</a><br>
</body></html>
